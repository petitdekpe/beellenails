USER STORIES - MODULE CODES PROMO
==================================

üë®‚Äçüíº GESTION DES CODES PROMO (ADMIN)
-------------------------------------

US-P01: Cr√©er un code promo
En tant qu'administrateur
Je veux cr√©er un nouveau code promo avec ses param√®tres (type, valeur, dates, limites)
Afin de proposer des r√©ductions aux clients

US-P02: G√©n√©rer un code al√©atoire
En tant qu'administrateur
Je veux g√©n√©rer automatiquement un code promo unique
Afin de gagner du temps et √©viter les doublons

US-P03: Voir la liste des codes promo
En tant qu'administrateur
Je veux consulter tous les codes promo avec leur statut
Afin de g√©rer l'ensemble des promotions

US-P04: Filtrer les codes promo
En tant qu'administrateur
Je veux filtrer les codes par statut (actif, expir√©, inactif) et rechercher par nom/code
Afin de trouver rapidement un code sp√©cifique

US-P05: Voir les d√©tails d'un code promo
En tant qu'administrateur
Je veux consulter les d√©tails et statistiques d'utilisation d'un code
Afin de mesurer son efficacit√©

US-P06: Modifier un code promo
En tant qu'administrateur
Je veux √©diter les param√®tres d'un code promo existant
Afin d'ajuster les conditions de la promotion

US-P07: Activer/D√©sactiver un code promo
En tant qu'administrateur
Je veux activer ou d√©sactiver rapidement un code promo
Afin de contr√¥ler sa disponibilit√© sans le supprimer

US-P08: Dupliquer un code promo
En tant qu'administrateur
Je veux dupliquer un code existant avec un nouveau code g√©n√©r√©
Afin de cr√©er rapidement des promotions similaires

US-P09: Supprimer un code promo
En tant qu'administrateur
Je veux supprimer un code promo non utilis√©
Afin de nettoyer la liste des codes obsol√®tes

US-P10: Voir les codes expirant bient√¥t
En tant qu'administrateur
Je veux √™tre alert√© des codes qui expirent dans les 7 prochains jours
Afin de d√©cider de prolonger ou non les promotions


üìä STATISTIQUES (ADMIN)
------------------------

US-P11: Consulter les statistiques globales
En tant qu'administrateur
Je veux voir les stats globales (codes actifs, total utilisations, CA g√©n√©r√©)
Afin d'avoir une vue d'ensemble des promotions

US-P12: Voir les statistiques par p√©riode
En tant qu'administrateur
Je veux filtrer les statistiques par p√©riode (7j, 30j, 90j, 1an)
Afin d'analyser les tendances

US-P13: Voir les codes les plus utilis√©s
En tant qu'administrateur
Je veux consulter le top 10 des codes les plus utilis√©s
Afin d'identifier les promotions les plus performantes

US-P14: Voir les utilisateurs les plus actifs
En tant qu'administrateur
Je veux voir le top 10 des utilisateurs utilisant le plus de codes promo
Afin d'identifier les comportements d'achat

US-P15: D√©tecter les tentatives suspectes
En tant qu'administrateur
Je veux voir les tentatives d'utilisation √©chou√©es ou suspectes
Afin de d√©tecter d'√©ventuels abus


üí≥ UTILISATION DES CODES (CLIENT)
----------------------------------

US-P16: Appliquer un code promo sur un rendez-vous
En tant qu'utilisateur client
Je veux entrer un code promo lors de la r√©servation
Afin de b√©n√©ficier d'une r√©duction

US-P17: Voir la r√©duction appliqu√©e
En tant qu'utilisateur client
Je veux voir le montant de la r√©duction apr√®s avoir saisi le code
Afin de v√©rifier l'√©conomie r√©alis√©e

US-P18: Voir les messages d'erreur clairs
En tant qu'utilisateur client
Je veux comprendre pourquoi mon code ne fonctionne pas (expir√©, limite atteinte, etc.)
Afin de savoir si je peux utiliser un autre code

US-P19: Appliquer un code promo sur une formation
En tant qu'utilisateur client
Je veux utiliser un code promo lors de l'achat d'une formation
Afin de payer moins cher


üîí R√àGLES DE VALIDATION
------------------------

US-P20: Valider le code actif
Le syst√®me doit v√©rifier que le code est actif
Afin d'emp√™cher l'utilisation de codes d√©sactiv√©s

US-P21: Valider la p√©riode de validit√©
Le syst√®me doit v√©rifier que la date actuelle est entre validFrom et validUntil
Afin d'emp√™cher l'utilisation de codes expir√©s ou futurs

US-P22: Valider le montant minimum
Le syst√®me doit v√©rifier que le panier atteint le montant minimum requis
Afin d'appliquer les conditions de la promotion

US-P23: Valider la limite globale d'utilisation
Le syst√®me doit v√©rifier que le nombre d'utilisations globales n'est pas d√©pass√©
Afin de limiter le budget de la promotion

US-P24: Valider la limite par utilisateur
Le syst√®me doit v√©rifier que l'utilisateur n'a pas d√©pass√© sa limite d'utilisation
Afin d'√©viter les abus

US-P25: Valider l'√©ligibilit√© de la prestation
Le syst√®me doit v√©rifier que le code est valide pour la prestation choisie
Afin d'appliquer les restrictions de la promotion


üí∞ CALCUL DE R√âDUCTION
-----------------------

US-P26: Calculer une r√©duction en pourcentage
Le syst√®me doit calculer X% du montant total
Afin d'appliquer une r√©duction proportionnelle

US-P27: Calculer une r√©duction en montant fixe
Le syst√®me doit soustraire un montant fixe du total
Afin d'appliquer une r√©duction absolue

US-P28: Appliquer une r√©duction maximale
Le syst√®me doit limiter la r√©duction au maximum d√©fini (si configur√©)
Afin de contr√¥ler le budget des promotions √† pourcentage


üìù TRA√áABILIT√â
--------------

US-P29: Enregistrer les tentatives d'utilisation
Le syst√®me doit enregistrer chaque tentative (r√©ussie ou √©chou√©e)
Afin de tracer l'utilisation des codes

US-P30: Incr√©menter le compteur d'utilisation
Le syst√®me doit augmenter currentUsage quand le code est valid√©
Afin de suivre le nombre d'utilisations

US-P31: Lier le code au rendez-vous
Le syst√®me doit associer le code promo au rendez-vous cr√©√©
Afin de garder l'historique des r√©ductions appliqu√©es


NOTES POUR LE QA TESTER
========================

Routes principales √† tester:
- /dashboard/promo-codes (liste - ADMIN)
- /dashboard/promo-codes/new (cr√©ation - ADMIN)
- /dashboard/promo-codes/{id} (d√©tail - ADMIN)
- /dashboard/promo-codes/{id}/edit (√©dition - ADMIN)
- /dashboard/promo-codes/{id}/toggle-status (activation/d√©sactivation - ADMIN)
- /dashboard/promo-codes/{id}/duplicate (duplication - ADMIN)
- /dashboard/promo-codes/{id}/delete (suppression - ADMIN)
- /dashboard/promo-codes/stats (statistiques - ADMIN)
- /dashboard/promo-codes/generate-code (g√©n√©ration - ADMIN)

Service principal:
- PromoCodeService->validatePromoCode() : validation compl√®te
- PromoCodeService->calculateDiscount() : calcul de r√©duction

Points de vigilance:
- V√©rifier que seuls les ADMIN peuvent acc√©der aux routes de gestion
- Tester tous les cas d'invalidation (expir√©, inactif, limite atteinte, etc.)
- V√©rifier le calcul correct des r√©ductions (pourcentage vs fixe)
- Tester la limite maximale de r√©duction pour les pourcentages
- V√©rifier qu'on ne peut pas supprimer un code avec des utilisations valid√©es
- Tester la duplication (nouveau code g√©n√©r√©, inactif par d√©faut)
- V√©rifier l'unicit√© des codes (pas de doublon)
- Tester les filtres de recherche et de statut
- V√©rifier que les codes sont en majuscules automatiquement
- Tester l'application sur diff√©rents types de prestations
- V√©rifier la pagination (20 items par page)

Cas limites √† tester:
- Code expirant exactement aujourd'hui
- R√©duction de 100%
- Montant minimum √©gal au panier
- Limite d'utilisation √† 1
- Code sans prestations √©ligibles (valable pour toutes)
- Code avec maximum discount sur un gros panier
