<html>
	<head>
		<meta charset="UTF-8">
		<title>
			{% block title %}Tableau de bord
			{% endblock %}
		</title>

		<link rel="apple-touch-icon" sizes="180x180" href="/favicon/apple-touch-icon.png">
		<link rel="icon" type="image/png" sizes="32x32" href="/favicon/favicon-32x32.png">
		<link rel="icon" type="image/png" sizes="16x16" href="/favicon/favicon-16x16.png">
		<link rel="manifest" href="/favicon/site.webmanifest">
		<link rel="mask-icon" href="/favicon/safari-pinned-tab.svg" color="#5bbad5">
		<meta name="msapplication-TileColor" content="#da532c">
		<meta name="theme-color" content="#ffffff">
		<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">


		<script src="https://cdn.tailwindcss.com"></script>
		<script src="https://cdnjs.cloudflare.com/ajax/libs/flowbite/2.2.0/flowbite.min.js"></script>


		{% block stylesheets %}
			<style>
				/* Pour les libellés des mois */
				.fc-toolbar-title,
				.fc-col-header-cell-cushion {
					text-transform: capitalize;
				}
			</style>
		{% endblock %}
		<script src="https://cdn.fedapay.com/checkout.js?v=1.1.7"></script>
		<script src="/js/preline.js"></script>
		{% block javascripts %}
			<script src='https://cdn.jsdelivr.net/npm/fullcalendar@6.1.11/index.global.min.js'></script>
			<script src='fullcalendar/core/locales/fr.global.js'></script>

		{% endblock %}

	</head>


	<body class="bg-gray-100">
		<div class="flex min-h-screen w-full">
			{% block body %}

				<button data-drawer-target="default-sidebar" data-drawer-toggle="default-sidebar" aria-controls="default-sidebar" type="button" class="inline-flex items-center p-2 mt-2 ms-3 text-sm text-gray-500 rounded-lg sm:hidden hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-gray-200 dark:text-gray-400 dark:hover:bg-gray-700 dark:focus:ring-gray-600">
					<span class="sr-only">Open sidebar</span>
					<svg class="w-6 h-6" aria-hidden="true" fill="currentColor" viewbox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
						<path clip-rule="evenodd" fill-rule="evenodd" d="M2 4.75A.75.75 0 012.75 4h14.5a.75.75 0 010 1.5H2.75A.75.75 0 012 4.75zm0 10.5a.75.75 0 01.75-.75h7.5a.75.75 0 010 1.5h-7.5a.75.75 0 01-.75-.75zM2 10a.75.75 0 01.75-.75h14.5a.75.75 0 010 1.5H2.75A.75.75 0 012 10z"></path>
					</svg>
				</button>

				{% include '_sidebar.html.twig' %}


				<div class="flex-1">
					<div class="relative overflow-hidden w-full h-20 bg-pink-500"></div>
					<h4 class="text-2xl font-bold px-4 py-6 text-gray-800">Transactions</h4>

					<div class="px-4">
						<section class="bg-gray-50 p-4 sm:p-6 rounded-xl shadow-sm">
							<div class="mx-auto max-w-screen-xl">
								<div class="bg-white shadow rounded-lg overflow-hidden">
									<div class="overflow-x-auto">
										<table id="transactions-table" class="min-w-full text-sm text-left text-gray-700">
											<thead class="text-xs uppercase bg-gray-100 text-gray-600">
												<tr>
													<th class="px-5 py-3 whitespace-nowrap">Client</th>
													<th class="px-5 py-3 whitespace-nowrap">Description</th>
													<th class="px-5 py-3 whitespace-nowrap">Montant</th>
													<th class="px-5 py-3 whitespace-nowrap">Statut</th>
													<th class="px-5 py-3 whitespace-nowrap">Téléphone</th>
													<th class="px-5 py-3 whitespace-nowrap">Créé le</th>
													<th class="px-5 py-3 whitespace-nowrap">Modifié le</th>
												</tr>
											</thead>
											<tbody class="divide-y divide-gray-200">
												{% for payment in payments %}
													<tr class="hover:bg-gray-50">
														<td class="px-5 py-3 font-medium text-gray-900 whitespace-nowrap">{{ payment.customer }}</td>
														<td class="px-5 py-3 text-gray-700">{{ payment.description }}</td>
														<td class="px-5 py-3 text-gray-700">{{ payment.amount }}
															FCFA</td>
														<td class="px-5 py-3 text-gray-700">{{ payment.status }}</td>
														<td class="px-5 py-3 text-gray-700">{{ payment.phoneNumber }}</td>
														<td class="px-5 py-3 text-gray-700">{{ payment.createdAt|date('d-m-Y H:i:s') }}</td>
														<td class="px-5 py-3 text-gray-700">{{ payment.updatedAt|date('d-m-Y H:i:s') }}</td>
													</tr>
												{% endfor %}
											</tbody>
										</table>
									</div>
								</div>
							</div>
						</section>
					</div>
				</div>


			{% endblock %}

			<script>
				document.addEventListener('DOMContentLoaded', () => {
const table = document.getElementById('transactions-table');
const tbody = table.querySelector('tbody');
const rows = Array.from(tbody.querySelectorAll('tr'));
const ITEMS_PER_PAGE = 10;
let currentPage = 1;

const pagination = document.createElement('div');
pagination.className = 'flex justify-center items-center gap-4 mt-6 text-sm';
table.insertAdjacentElement('afterend', pagination);

function updatePaginationControls(totalPages) {
pagination.innerHTML = '';

const prev = document.createElement('button');
prev.textContent = 'Précédent';
prev.className = 'px-3 py-1 rounded bg-gray-200 hover:bg-gray-300 disabled:opacity-50';
prev.disabled = currentPage === 1;
prev.onclick = () => {
currentPage--;
renderPage();
};

const next = document.createElement('button');
next.textContent = 'Suivant';
next.className = 'px-3 py-1 rounded bg-gray-200 hover:bg-gray-300 disabled:opacity-50';
next.disabled = currentPage === totalPages;
next.onclick = () => {
currentPage++;
renderPage();
};

const info = document.createElement('span');
info.textContent = `Page ${currentPage} sur ${totalPages}`;

pagination.append(prev, info, next);
}

function renderPage() {
const totalPages = Math.ceil(rows.length / ITEMS_PER_PAGE);
const start = (currentPage - 1) * ITEMS_PER_PAGE;
const end = currentPage * ITEMS_PER_PAGE;

rows.forEach((row, index) => {
row.style.display = index >= start && index < end ? '' : 'none';
});

updatePaginationControls(totalPages);
}

// Initial render
renderPage();
});
			</script>
